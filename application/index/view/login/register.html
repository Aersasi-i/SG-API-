<!DOCTYPE html>
<html lang="en">

{include file="index@public/head"}

<body>
    {include file="index@public/menu"}
    {include file="index@public/header"}
    <div class="lime-container">
        <div class="lime-body">
            <div class="container">
                <div class="row">
                    <div class="col-md-12">
                        <div class="page-title">
                            <h3>注册</h3>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col">
                        <div class="card">
                            <div class="card-body">
                                <h5 class="card-title">用户注册</h5>
                                <p>还没有注册本站的用户可在此注册. </p>
                                <div class="form-group">
                                    <label for="exampleInputEmail1">邮箱地址</label>
                                    <input type="email" class="form-control" id="mail" aria-describedby="emailHelp" placeholder="Enter email">
                                    <small id="emailHelp" class="form-text text-muted">输入邮箱地址</small>
                                </div>
                                <div class="form-group">
                                    <label for="exampleInputPassword1">密码</label>
                                    <input type="password" id="pass" class="form-control" id="exampleInputPassword1" placeholder="输入你的密码">
                                </div>
                                <div class="form-group">
                                    <label for="exampleInputPassword1">确认密码</label>
                                    <input type="password" id="pass_1" class="form-control" id="exampleInputPassword1" placeholder="输入你的密码">
                                </div>
                                <div class="form-group">
                                    <label for="exampleInputPassword1">QQ</label>
                                    <input type="text" id="qq" class="form-control" id="exampleInputPassword1" placeholder="请如实填写">
                                </div>
                                
                                <button id="register" class="btn btn-primary">
                                    注册
                                </button>
                                <a href="/login.html" class="btn btn-secondary btn-rounded">已有账户点击登录</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <input type="hidden" id="clicaptcha-submit-info" name="clicaptcha-submit-info">
        <div class="lime-footer">
            <div class="container">
                <div class="row">
                    <div class="col-md-12">
                        <span class="footer-text">{$info.banquan}</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Javascripts -->
    {include file="index@public/footer"}
    <script type="text/javascript">
        $("#register").click(function(){
            var mail=$("#mail").val();
            var reg = /^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/;
            isok= reg.test(mail);
            var pass=$("#pass").val();
            var pass_1=$("#pass_1").val();
            var qq=$("#qq").val();
            var r = /^[1-9][0-9]+$/gi;

            if (mail=='') {
                message('error', '邮箱不能为空');
                return false;
            }
            if (!isok) {
                message('error', '邮箱格式错误');
                return false;
            }
            if (pass=='') {
                message('error', '密码不能为空');
                return false;
            }
            if (pass!=pass_1) {
                message('error', '两次密码输入不一致');
                return false;
            }
            if (qq=='') {
                message('error', '请输入QQ号');
                return false;
            }
            if (qq.length<'5') {
                message('error', '请输入正确长度的QQ号');
                return false;
            }
            if (!r.test(qq)) {
                message('error', 'QQ号只能是数字');
                return false;
            }
            $('#register').attr("disabled",true);
            $("#register").html('<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>请稍后...');
            $.ajax({
                type: "post",
                url: "ajaxregister.html",
                dataType: "json",
                data : { "mail" :mail,"pass" :pass,"qq":qq},
                async: true,
                success: function(data) {
                    $("#register").html('注册');
                    $('#register').removeAttr("disabled");
                    console.log(data);
                    if (data.code==1) {

                        message('success', data.msg);
                    }
                    if (data.code==0) {

                        message('error', data.msg);
                    }
                },
                error: function() {
                    $("#register").html('注册');
                    message('error', '请检查你的网络');
                }
            })
        })
    </script>

</body>

</html>