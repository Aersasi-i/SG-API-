<!DOCTYPE html>
<html lang="en">

{include file="index@public/head"}

<body>
    {include file="index@public/menu"}
    {include file="index@public/header"}

    <div class="lime-container">
            <div class="lime-body">
                <div class="container">
                    <div class="row">
                        <div class="col-md-12">
                            <div class="page-title">
                                
                                <h3>账号设置</h3>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <div class="card">
                                <div class="card-body">
                                    <h5 class="card-title">修改密码</h5>
                                    <p>密码不会展示在输入框，如需修改请填写新密码后直接提交即可</p>
                                    <form>
                                        <div class="form-group">
                                            <label for="exampleInputEmail1">账号</label>
                                            <input type="email" class="form-control" id="exampleInputEmail1" value="{$userinfo.email}" disabled="disabled" >
                                            <small id="emailHelp" class="form-text text-muted" >账号不可修改，如需修改请联系系统管理员</small>
                                        </div>
                                        <div class="form-group">
                                            <label for="exampleInputPassword1">输入旧密码</label>
                                            <input type="password" class="form-control" id="oldpass" value="" placeholder="Old Password" >
                                        </div>
                                        <div class="form-group">
                                            <label for="exampleInputPassword1">输入新密码</label>
                                            <input type="password" class="form-control" id="newpass" placeholder="New Password" value="">
                                        </div>
                                        <div class="form-group">
                                            <label for="exampleInputPassword1">确认新密码</label>
                                            <input type="password" class="form-control" id="newpass1" placeholder="New Password" value="">
                                        </div>
                                        
                                        <button type="button" id="uppass" class="btn btn-primary">提交</button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                   
                </div>
            </div>
            <div class="lime-footer">
                <div class="container">
                    <div class="row">
                        <div class="col-md-12">
                            <span class="footer-text">{$info.banquan}</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Javascripts -->
    {include file="index@public/footer"}
    <script type="text/javascript">
        $("#uppass").click(function(){
            var oldpass=$("#oldpass").val();
            var newpass=$("#newpass").val();
            var newpass1=$("#newpass1").val();
            
            if (oldpass=='') {
                message('error','旧密码不能为空');
                return false;
            }
            if (newpass=='') {
                message('error','新密码不能为空');
                return false;
            }
            if (newpass1=='') {
                message('error','新密码不能为空');
                return false;
            }
            if (newpass!=newpass1) {
                message('error','两次密码输入不一致');
                return false;
            }
            $('#uppass').attr("disabled",true);
            $("#uppass").html('<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>请稍后...');
            $.ajax({
                type: "post",
                url: "ajaxupuserpwd.html",
                dataType: "json",
                data : { "old" :oldpass,"newpass" :newpass},
                async: true,
                success: function(data) {
                    $("#register").html('注册');
                    $('#register').removeAttr("disabled");
                    console.log(data);
                    if (data.code==1) {

                        message('success', data.msg);
                        setTimeout(function() {
                            location.href = data.url;
                        }, 1000);
                    }
                    if (data.code==0) {

                        message('error', data.msg);
                    }
                },
                error: function() {
                    $("#register").html('注册');
                    message('error', '请检查你的网络');
                }
            })
        })
    </script>
