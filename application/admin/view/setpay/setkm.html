<!DOCTYPE html>
<html>
{include file="public/head"}
</head>

<body>
    <div class="main-wrapper" id="main-wrapper">
        <!-- ============================================================== -->
        <!-- Preloader - style you can find in spinners.css -->
        <!-- ============================================================== -->
        <div class="preloader">
            <div class="loader">
                <div class="loader__figure"></div>
                <p class="loader__label">SGCODE Admin</p>
            </div>
        </div>
        <!-- ============================================================== -->
        <!-- Preloader - style you can find in spinners.css -->
        <!-- ============================================================== -->
        {include file="public/header"}
        <!-- ============================================================== -->
        <!-- Sidebar scss in sidebar.scss -->
        <!-- ============================================================== -->
        <!-- ============================================================== -->
        <!-- Sidebar scss in sidebar.scss -->
        <!-- ============================================================== -->
        {include file="public/leftmenu"}
        <!-- ============================================================== -->
        <!-- Sidebar scss in sidebar.scss -->
        <!-- ============================================================== -->
        <!-- ============================================================== -->
        <!-- Page wrapper scss in scafholding.scss -->
        <!-- ============================================================== -->
        <div class="page-wrapper">
            <!-- ============================================================== -->
            <!-- Title and breadcrumb -->
            <!-- ============================================================== -->
            <!-- ============================================================== -->
            <!-- Container fluid scss in scafholding.scss -->
            <!-- ============================================================== -->
            <div class="container-fluid">
                <div class="row">
                    <div class="col s12">
                        <div class="card">
                            <div class="card-content">
                                <h5 class="card-title">添加卡密</h5>
                                <p>一键生成卡密</p>
                                <form class="formValidate" id="form-adv-add">
                                    <div class="row">
                                        <div class="col s12">
                                            <div class="h-form-label">
                                                <label>选择VIP方式</label>
                                            </div>
                                        </div>
                                        <div class="input-field col s12">
                                            <select name="viptype">
                                                <option value="" selected>选择VIP方式</option>
                                                {volist name="viplist" id="vp"}
                                                <option value="{$vp.id}">{$vp.vip_name}</option>
                                                {/volist}
                                            </select>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="input-field col s12">
                                            <label for="uname">生成数量*</label>
                                            <input id="kmnum" name="kmnum" type="text" data-error=".errorTxt1" value="">
                                            <div class="errorTxt1"></div>
                                        </div>
                                        
                                        <div class="input-field col s12">
                                            <button class="btn waves-effect waves-light right submit" type="button" onclick="formdata()">提交</button>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- ============================================================== -->
            <!-- Container fluid scss in scafholding.scss -->
            <!-- ============================================================== -->
            <footer class="center-align m-b-30">Theme by <a href="https://www.sgcode.cn">SGCODE.CN</a>.</footer>
        </div>
        <!-- ============================================================== -->
        <!-- Page wrapper scss in scafholding.scss -->
        <!-- ============================================================== -->
        <!-- ============================================================== -->
        <!-- Right Sidebar -->
        <!-- ============================================================== -->
        {include file="public/setting"}
        <!-- ============================================================== -->
        <!-- Right Sidebar -->
        <!-- ============================================================== -->
    </div>
    <!-- ============================================================== -->
    <!-- All Required js -->
    <!-- ============================================================== -->
    {include file="public/footer"}
    <script type="text/javascript">
    function formdata() {
        var form = document.getElementById("form-adv-add");
        var formdata = new FormData(form);
        $.ajax({
            type: "POST",
            url: "{:url('setpay/addkm')}",
            processData: false, // 不要处理发送的数据
            contentType: false, // 不要设置Content-Type请求头
            data: formdata,
            dataType: 'json',
            success: function(data) {
                if (data.code == 1) {
                    //window.location.href="你所要跳转的页面";
                    toastr.success(data.msg, '成功', { positionClass: 'toast-top-center', containerId: 'toast-top-center' });
                    //message('success', data.msg);
                    setTimeout(function() {
                        location.href = data.url;
                    }, 1000);
                }
                if (data.code == 0) {
                    toastr.info(data.msg, '警告', { positionClass: 'toast-top-center', containerId: 'toast-top-center' });
                }
            }
        });
    }
    </script>
</body>

</html>